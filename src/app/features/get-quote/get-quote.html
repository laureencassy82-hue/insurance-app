<div class="bg-gray-light flex flex-col items-center">

  <!-- Header Logo -->
  <div class="hidden md:block">
    <img [src]="headerImage" alt="Dai-ichi Life Logo" class="h-[300px] w-auto" />
  </div>

  <!-- Main Content -->
  <div class="min-h-screen flex flex-col md:flex-row bg-purple-700 p-4 md:p-14 w-full gap-9">
    <!-- Mobile Page Title -->
    <div class="md:hidden w-full bg-primary-yellow py-4 flex items-center justify-center">
      <h1 class="font-bold text-xl text-black text-center">{{ 'GET_QUOTE.TITLE' | translate }}</h1>
    </div>

    <!-- Right Section: Product Highlights -->
    <div class="w-full md:w-2/5 flex flex-col items-center order-1 md:order-2">
      <div class="w-full bg-white rounded-card shadow-card overflow-hidden">
        <div class="w-full bg-primary-yellow h-16 flex items-center justify-center">
          <h2 class="font-bold text-xl md:text-2xl text-black text-center">{{ 'PRODUCT_HIGHLIGHTS.TITLE' | translate }}</h2>
        </div>
        <div class="p-4 md:p-8 flex flex-col items-center space-y-6">
          <img src="assets/images/Product-highlights.png" alt="Product" class="w-50 h-auto hidden md:block" />
          <ul class="text-gray-800 text-base md:text-lg text-left list-disc list-inside w-full px-4 md:px-8 space-y-2">
            <li>{{ 'PRODUCT_HIGHLIGHTS.ITEM1' | translate }}</li>
            <li>{{ 'PRODUCT_HIGHLIGHTS.ITEM2' | translate }}</li>
            <li>{{ 'PRODUCT_HIGHLIGHTS.ITEM3' | translate }}</li>
          </ul>
          <p class="text-black text-sm md:text-base mt-8 leading-relaxed text-left w-full px-4 md:px-8">
            {{ 'PRODUCT_HIGHLIGHTS.NOTE' | translate }}
          </p>
          <button class="btn-purple bg-gradient-to-b from-[#D6C8F0] to-primary-purple hover:from-primary-purple hover:to-primary-purple">
            {{ 'PRODUCT_HIGHLIGHTS.BROCHURE' | translate }}
          </button>
        </div>
      </div>
    </div>

    <!-- Left Section: Form -->
    <div class="w-full md:w-3/5 flex flex-col items-center order-2 md:order-1">
      <div class="w-full bg-white rounded-card shadow-card flex flex-col justify-center items-center overflow-hidden">

        <!-- Form Header -->
        <div class="w-full bg-primary-yellow h-16 flex items-center justify-center">
          <h2 class="font-bold text-xl md:text-2xl text-black text-center">
            {{ 'GET_QUOTE.TITLE' | translate }}
          </h2>
        </div>

        <!-- Form Container -->
        <div class="w-full p-4 md:p-10">
          <form #quoteForm="ngForm" class="flex flex-col space-y-5" novalidate>

            <!-- Full Name -->
            <div class="flex flex-col">
              <label for="fullName" class="text-sm font-medium text-secondary-purple mb-1">
                {{ 'GET_QUOTE.FULL_NAME' | translate }} <span class="text-red-500">*</span>
              </label>
              <input
                id="fullName"
                type="text"
                placeholder="{{ 'GET_QUOTE.FULL_NAME' | translate }}"
                name="fullName"
                required
                [(ngModel)]="formData.fullName"
                #fullNameRef="ngModel"
                (blur)="fullNameRef.control.markAsTouched()"
                class="input-field"
              />
              <small class="text-red-500 text-xs mt-1" *ngIf="fullNameRef.invalid && fullNameRef.touched">
                {{ 'ERROR.NAME' | translate }}
              </small>
            </div>

            <!-- Gender -->
            <div class="flex flex-col">
              <label class="text-sm font-medium text-secondary-purple mb-2">
                {{ 'GET_QUOTE.GENDER' | translate }} <span class="text-red-500">*</span>
              </label>
              <div class="flex gap-3">
                <button
                  type="button"
                  (click)="formData.gender='male'"
                  [ngClass]="formData.gender === 'male' ? 'bg-primary-yellow text-black' : 'bg-white text-black'"
                  class="px-4 py-2 rounded-lg border border-gray-300 hover:bg-primary-yellow hover:text-black transition"
                >
                  {{ 'GET_QUOTE.MALE' | translate }}
                </button>

                <button
                  type="button"
                  (click)="formData.gender='female'"
                  [ngClass]="formData.gender === 'female' ? 'bg-primary-yellow text-black' : 'bg-white text-black'"
                  class="px-4 py-2 rounded-lg border border-gray-300 hover:bg-primary-yellow hover:text-black transition"
                >
                  {{ 'GET_QUOTE.FEMALE' | translate }}
                </button>
              </div>
              <small class="text-red-500 text-xs mt-1" *ngIf="quoteForm.submitted && !formData.gender">
                {{ 'ERROR.GENDER' | translate }}
              </small>
            </div>

            <!-- Date of Birth -->
            <div class="flex flex-col">
              <label for="dob" class="text-sm font-medium text-secondary-purple mb-1">
                {{ 'GET_QUOTE.DATE_OF_BIRTH' | translate }} <span class="text-red-500">*</span>
              </label>
              <input
                id="dob"
                type="date"
                required
                name="dob"
                [(ngModel)]="formData.dob"
                #dobRef="ngModel"
                (blur)="dobRef.control.markAsTouched()"
                class="input-field"
              />
              <small class="text-red-500 text-xs mt-1" *ngIf="dobRef.invalid && dobRef.touched">
                {{ 'ERROR.DATE' | translate }}
              </small>
            </div>

            <!-- Contact Number -->
            <div class="flex flex-col">
              <label for="phone" class="text-sm font-medium text-secondary-purple mb-1">
                {{ 'GET_QUOTE.CONTACT_NUMBER' | translate }} <span class="text-red-500">*</span>
              </label>

              <div class="flex flex-col gap-2 sm:flex-row sm:gap-2 relative country-dropdown">
                <!-- Custom Country Dropdown -->
                <div class="relative w-full sm:w-40 z-50">
                  <button
                    type="button"
                    (click)="toggleDropdown()"
                    class="flex items-center justify-between w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-primary-purple"
                  >
                    <div class="flex items-center space-x-2">
                      <img
                        [src]="selectedCountry.flag"
                        alt="flag"
                        class="w-5 h-4 rounded-sm object-cover"
                      />
                      <span>{{ selectedCountry.code }}</span>
                    </div>
                    <span class="material-icons-outlined text-gray-500 text-base">arrow_drop_down</span>
                  </button>

                  <!-- Dropdown List -->
                  <ul
                    *ngIf="dropdownOpen"
                    class="absolute z-50 mt-1 w-full bg-white border border-gray-300 rounded-lg shadow-lg max-h-56 overflow-y-auto"
                  >
                    <li *ngFor="let country of countries" (click)="selectCountry(country)"
                      class="flex items-center justify-between px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm">
                      <div class="flex items-center space-x-2">
                        <img [src]="country.flag" alt="flag" class="w-5 h-4 rounded-sm object-cover"/>
                        <span class="truncate">{{ country.name }}</span>
                      </div>
                      <span class="text-gray-500 ml-2 flex-shrink-0">{{ country.code }}</span>
                    </li>
                  </ul>
                </div>

                <!-- Phone Input -->
                <input
                  id="phone"
                  type="text"
                  placeholder="{{ 'GET_QUOTE.CONTACT_NUMBER' | translate }}"
                  required
                  name="phone"
                  [(ngModel)]="formData.phone"
                  #phoneRef="ngModel"
                  (blur)="phoneRef.control.markAsTouched()"
                  class="border border-gray-300 rounded-lg px-3 py-2 text-gray-700 text-sm w-full focus:outline-none focus:ring-2 focus:ring-primary-purple"
                />
              </div>
            </div>

            <!-- Address -->
            <div class="flex flex-col">
              <label for="address" class="text-sm font-medium text-secondary-purple mb-1">
                {{ 'GET_QUOTE.ADDRESS' | translate }} <span class="text-red-500">*</span>
              </label>
              <textarea
                id="address"
                rows="3"
                placeholder="{{ 'GET_QUOTE.ADDRESS' | translate }}"
                required
                name="address"
                [(ngModel)]="formData.address"
                #addressRef="ngModel"
                (blur)="addressRef.control.markAsTouched()"
                class="textarea-field"
              ></textarea>
              <small class="text-red-500 text-xs mt-1" *ngIf="addressRef.invalid && addressRef.touched">
                {{ 'ERROR.ADDRESS' | translate }}
              </small>
            </div>

            <!-- National ID Upload -->
            <div class="flex flex-col">
              <label class="block text-sm font-medium mb-2 text-secondary-purple">
                {{ 'GET_QUOTE.NATIONAL_ID' | translate }} <span class="text-red-500">*</span>
              </label>
              <p class="text-xs text-gray-500 mb-3">{{ 'GET_QUOTE.NATIONAL_ID_NOTE' | translate }}</p>

              <div class="border rounded-card p-6 flex flex-col items-center justify-center space-y-3">
                <label class="btn-purple cursor-pointer flex items-center justify-center">
                  {{ 'SELECT_FILES' | translate }}
                  <input type="file" multiple accept=".jpg,.jpeg,.png,.bmp,.tiff,.svg" class="hidden" (change)="onFileSelected($event)" />
                </label>

                <small class="text-red-500 text-xs mt-1" *ngIf="uploadedFiles.length < 2 && quoteForm.submitted">
                  {{ 'ERROR.ID' | translate }}
                </small>

                <!-- Highlighted Row for Image Previews -->
                <div *ngIf="uploadedFiles.length > 0" class="flex flex-row items-center justify-center gap-4 mt-4 p-4 bg-gray-100 rounded-lg shadow-md highlight-row">
                  <div *ngFor="let img of uploadedFiles; let i = index" class="relative w-32 h-32 rounded-md overflow-hidden hover:shadow-lg transition cursor-pointer" (click)="viewImage(img)" title="Click to view image">
                    <img [src]="img" alt="Preview" class="w-full h-full object-cover" />
                    <button type="button" (click)="removeImage(i); $event.stopPropagation()" class="absolute top-1 right-1 bg-red-500 text-white text-xs px-2 py-1 rounded-full hover:bg-red-600">✕</button>
                    <p class="absolute bottom-1 left-0 w-full text-center text-xs bg-white/60 text-gray-800 font-medium">
                      {{ i === 0 ? ('GET_QUOTE.FRONT' | translate) : ('GET_QUOTE.BACK' | translate) }}
                    </p>
                  </div>
                </div>
              </div>
            </div>

          </form>
        </div>
      </div>

      <!-- Next Button -->
      <div class="w-full mt-4 text-center border-t-2 border-primary-yellow pt-4">
        <button type="button" class="btn-yellow w-full" (click)="quoteForm.control.markAllAsTouched(); goToSelectPlan()">
          {{ 'GET_QUOTE.NEXT' | translate }}
        </button>
      </div>
    </div>

  </div>
</div>